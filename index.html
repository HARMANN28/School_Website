<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shri Guru Nanak Mission Girls High Secondary School - Excellence in Education</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --saffron-light: #ff9933;
            --saffron-primary: #ff8c00;
            --saffron-deep: #e67e00;
            --maroon-light: #a0522d;
            --maroon-primary: #8b0000;
            --maroon-deep: #650000;
            --cream: #fef7e6;
            --warm-white: #fefdfb;
            --gold-accent: #daa520;
            --text-dark: #2c1810;
            --text-medium: #5a453a;
            --shadow-subtle: 0 4px 20px rgba(139, 0, 0, 0.08);
            --shadow-medium: 0 8px 40px rgba(139, 0, 0, 0.12);
            --shadow-strong: 0 16px 60px rgba(139, 0, 0, 0.15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.7;
            color: var(--text-dark);
            background: linear-gradient(135deg, var(--cream) 0%, var(--warm-white) 50%, #fff8f0 100%);
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        /* Elegant Header */
        header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 153, 51, 0.1);
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.2rem 0;
        }

        .logo {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--maroon-primary);
            text-decoration: none;
            letter-spacing: -0.5px;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .logo::before {
            content: "‡©¥";
            font-size: 1.8rem;
            color: var(--saffron-primary);
            font-weight: bold;
        }

        .nav-menu {
            display: flex;
            list-style: none;
            gap: 2.5rem;
            align-items: center;
        }

        .nav-menu a {
            text-decoration: none;
            color: var(--text-medium);
            font-weight: 500;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            position: relative;
            padding: 0.5rem 0;
        }

        .nav-menu a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 0;
            height: 2px;
            background: linear-gradient(90deg, var(--saffron-primary), var(--maroon-primary));
            transition: all 0.3s ease;
            transform: translateX(-50%);
        }

        .nav-menu a:hover {
            color: var(--maroon-primary);
        }

        .nav-menu a:hover::after {
            width: 100%;
        }

        /* Hero Section - Masterpiece */
        .hero {
            min-height: 100vh;
            display: flex;
            align-items: center;
            position: relative;
            overflow: hidden;
            background: linear-gradient(135deg, var(--cream) 0%, var(--warm-white) 100%);
            padding: 8rem 0 4rem;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -20%;
            width: 80%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 153, 51, 0.08) 0%, transparent 70%);
            border-radius: 50%;
            animation: float 20s ease-in-out infinite;
        }

        .hero-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            align-items: center;
            gap: 4rem;
            position: relative;
            z-index: 2;
        }

        .hero-text h1 {
            font-family: 'Playfair Display', serif;
            font-size: 3.5rem;
            font-weight: 700;
            line-height: 1.2;
            color: var(--maroon-primary);
            margin-bottom: 1.5rem;
            letter-spacing: -1px;
        }

        .hero-text .subtitle {
            font-size: 1.3rem;
            color: var(--text-medium);
            margin-bottom: 2rem;
            font-weight: 300;
            line-height: 1.6;
        }

        .hero-text .highlight {
            background: linear-gradient(135deg, var(--saffron-primary), var(--gold-accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 600;
        }

        .cta-group {
            display: flex;
            gap: 1.5rem;
            margin-top: 2.5rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--saffron-primary), var(--saffron-deep));
            color: white;
            padding: 1rem 2.5rem;
            border: none;
            border-radius: 50px;
            font-weight: 600;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-medium);
            position: relative;
            overflow: hidden;
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .btn-primary:hover::before {
            left: 100%;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-strong);
        }

        .btn-secondary {
            background: transparent;
            color: var(--maroon-primary);
            padding: 1rem 2.5rem;
            border: 2px solid var(--maroon-primary);
            border-radius: 50px;
            font-weight: 600;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            background: var(--maroon-primary);
            color: white;
            transform: translateY(-2px);
        }

        /* Notice Board - Premium Design */
        .notice-board {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(254, 247, 230, 0.9));
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 2.5rem;
            border: 1px solid rgba(255, 153, 51, 0.2);
            box-shadow: var(--shadow-medium);
            position: relative;
            overflow: hidden;
        }

        .notice-board::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--saffron-primary), var(--maroon-primary), var(--saffron-primary));
        }

        .notice-board h2 {
            font-family: 'Playfair Display', serif;
            color: var(--maroon-primary);
            margin-bottom: 1.5rem;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .notice-item {
            background: white;
            margin: 1rem 0;
            padding: 1.5rem;
            border-radius: 16px;
            display: flex;
            align-items: center;
            gap: 1.5rem;
            transition: all 0.3s ease;
            border-left: 4px solid var(--saffron-primary);
            box-shadow: var(--shadow-subtle);
        }

        .notice-item:hover {
            transform: translateX(8px);
            box-shadow: var(--shadow-medium);
        }

        .notice-date {
            background: linear-gradient(135deg, var(--maroon-primary), var(--maroon-deep));
            color: white;
            padding: 0.8rem;
            border-radius: 12px;
            font-weight: 600;
            min-width: 90px;
            text-align: center;
            box-shadow: var(--shadow-subtle);
        }

        /* Main Content Sections */
        .section {
            padding: 6rem 0;
            position: relative;
        }

        .section-header {
            text-align: center;
            margin-bottom: 4rem;
        }

        .section-header h2 {
            font-family: 'Playfair Display', serif;
            font-size: 2.8rem;
            color: var(--maroon-primary);
            margin-bottom: 1rem;
            position: relative;
        }

        .section-header h2::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 3px;
            background: linear-gradient(90deg, var(--saffron-primary), var(--maroon-primary));
            border-radius: 2px;
        }

        .section-header p {
            font-size: 1.1rem;
            color: var(--text-medium);
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.7;
        }

        /* Values Grid - Award Winning Design */
        .values-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2.5rem;
            margin: 4rem 0;
        }

        .value-card {
            background: white;
            padding: 3rem 2.5rem;
            border-radius: 24px;
            text-align: center;
            transition: all 0.2s ease;
            box-shadow: var(--shadow-subtle);
            position: relative;
            overflow: hidden;
            border-top: 4px solid var(--saffron-primary);
        }

        .value-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(255, 153, 51, 0.05), rgba(139, 0, 0, 0.05));
            transition: left 0.2s ease;
        }

        .value-card:hover::before {
            left: 0;
        }

        .value-card:hover {
            transform: translateY(-12px) scale(1.02);
            box-shadow: var(--shadow-strong);
        }

        .value-card:nth-child(2) {
            border-top-color: var(--maroon-primary);
        }

        .value-card:nth-child(3) {
            border-top-color: var(--gold-accent);
        }

        .value-icon {
            font-size: 3.5rem;
            margin-bottom: 1.5rem;
            filter: hue-rotate(20deg);
        }

        .value-card h3 {
            font-family: 'Playfair Display', serif;
            font-size: 1.8rem;
            color: var(--maroon-primary);
            margin-bottom: 1.5rem;
            font-weight: 600;
        }

        .value-card p {
            color: var(--text-medium);
            line-height: 1.7;
            position: relative;
            z-index: 2;
        }

        /* Footer */
        footer {
            background: var(--text-dark);
            color: var(--cream);
            padding: 4rem 0 2rem;
            position: relative;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 3rem;
            margin-bottom: 2rem;
        }

        .footer-section h3 {
            font-family: 'Playfair Display', serif;
            color: var(--saffron-light);
            margin-bottom: 1rem;
        }

        .footer-bottom {
            text-align: center;
            padding-top: 2rem;
            border-top: 1px solid rgba(255, 153, 51, 0.2);
            color: rgba(254, 247, 230, 0.7);
        }

        /* Animations */
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .hero-content {
                grid-template-columns: 1fr;
                text-align: center;
                gap: 3rem;
            }
            
            .hero-text h1 {
                font-size: 2.8rem;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 0 1rem;
            }
            
            .header-content {
                flex-direction: column;
                gap: 1rem;
            }

            .nav-menu {
                flex-wrap: wrap;
                gap: 1.5rem;
            }

            .hero-text h1 {
                font-size: 2.2rem;
            }

            .values-grid {
                grid-template-columns: 1fr;
                gap: 2rem;
            }

            .section {
                padding: 4rem 0;
            }

            .cta-group {
                flex-direction: column;
                align-items: center;
            }
        }

        /* Scroll reveal animations */
        .reveal {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s ease;
        }

        .reveal.active {
            opacity: 1;
            transform: translateY(0);
        }
        
        /* Loading spinner */
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 4px solid var(--saffron-primary);
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading-text {
            text-align: center;
            color: var(--text-medium);
            margin-top: 10px;
        }
        
        /* Error messages */
        .error-message {
            color: #d32f2f;
            background-color: #ffebee;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
            border-left: 4px solid #d32f2f;
        }
        
        .api-error-banner {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 2000;
            padding: 1rem;
            text-align: center;
            background-color: #d32f2f;
            color: white;
            font-weight: 500;
        }
        
        /* Debug Panel */
        .debug-panel {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 1rem;
            font-family: monospace;
            font-size: 0.9rem;
            z-index: 3000;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .debug-toggle {
            position: fixed;
            bottom: 0;
            right: 20px;
            background: var(--saffron-primary);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 5px 5px 0 0;
            cursor: pointer;
            z-index: 3001;
        }
    </style>
</head>
<body>
    <div class="debug-toggle" id="debugToggle" style="display: none;">Show Debug</div>
    <div class="debug-panel" id="debugPanel" style="display: none;">
        <h3>Debug Console</h3>
        <div id="debugContent"></div>
    </div>
    
    <header>
        <div class="container">
            <div class="header-content">
                <a href="#" class="logo">SGNMGHS</a>
                <nav>
                    <ul class="nav-menu">
                        <li><a href="#home">Home</a></li>
                        <li><a href="about-us.html">About Us</a></li>
                        <li><a href="admissions.html">Admissions</a></li>
                        <li><a href="academics.html">Academics</a></li>
                        <li><a href="events.html">Events</a></li>
                        <li><a href="gallery.html">Gallery</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <main>
        <section class="hero" id="home">
            <div class="container">
                <div class="hero-content">
                    <div class="hero-text reveal">
                        <h1>Shri Guru Nanak Mission<br><span class="highlight">Girls High Secondary School</span></h1>
                        <p class="subtitle">Where tradition meets innovation, nurturing tomorrow's leaders with values, knowledge, and compassion since 1959.</p>
                        
                        <div class="cta-group">
                            <a href="admissions.html" class="btn-primary">
                                <span>Apply Now</span>
                                <span>‚Üí</span>
                            </a>
                            <a href="#about" class="btn-secondary">
                                <span>Learn More</span>
                                <span>‚Üì</span>
                            </a>
                        </div>
                    </div>
                    
                    <div class="notice-board reveal" id="notice-board">
                        <h2>üì¢ Latest Announcements</h2>
                        <div class="spinner"></div>
                        <p class="loading-text">Loading announcements...</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="section" id="about">
            <div class="container">
                <div class="section-header reveal">
                    <h2>Our Distinguished Heritage</h2>
                    <p>A legacy of excellence spanning over 65 years, building character and nurturing dreams</p>
                </div>
                
                <div class="reveal">
                    <p style="font-size: 1.1rem; line-height: 1.8; text-align: center; max-width: 900px; margin: 0 auto 3rem; color: var(--text-medium);">
                        The Shri Gurunanak Mission H.S. School, established in 1959 in Premnagar, Jabalpur, was founded to serve the growing educational needs of students from all walks of life. Our institution functions as a Hindi/English medium school where students belonging to all castes, religions, and creeds are motivated to become good scholars and exemplary individuals.
                    </p>
                    
                    <p style="font-size: 1.1rem; line-height: 1.8; text-align: center; max-width: 900px; margin: 0 auto; color: var(--text-medium);">
                        ‡§∂‡•ç‡§∞‡•Ä ‡§ó‡•Å‡§∞‡•Å‡§®‡§æ‡§®‡§ï ‡§Æ‡§ø‡§∂‡§® ‡§â.‡§Æ‡§æ.‡§∂‡§æ‡§≤‡§æ, ‡§™‡•ç‡§∞‡•á‡§Æ‡§®‡§ó‡§∞, ‡§ú‡§¨‡§≤‡§™‡•Å‡§∞ ‡§∏‡§® 1959 ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§æ‡§ú ‡§ï‡•á ‡§π‡§∞ ‡§∏‡•ç‡§§‡§∞ ‡§ï‡•á ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§∞‡•ç‡§•‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•ã ‡§∂‡§ø‡§ï‡•ç‡§∑‡§æ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§ï‡§∞‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡•ç‡§∞‡§æ‡§∞‡§Æ‡•ç‡§≠ ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à‡•§ ‡§ó‡•Å‡§∞‡•Å‡§ó‡•ã‡§µ‡§ø‡§Ç‡§¶ ‡§∏‡§ø‡§Ç‡§π ‡§ú‡•Ä ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§∞‡§ö‡§ø‡§§ ‡§∂‡§¨‡•ç‡§¶ "‡§∂‡•Å‡§≠ ‡§ï‡§∞‡§Æ‡§® ‡§§‡•á ‡§ï‡§¨‡§π‡•Å‡§Å ‡§® ‡§ü‡§∞‡•ã‡§Ç" ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§¶‡•Ä ‡§ú‡§æ‡§®‡•á ‡§µ‡§æ‡§≤‡•Ä ‡§∏‡•Ä‡§ñ ‡§ï‡•ã ‡§∂‡§æ‡§≤‡§æ ‡§≤‡§ó‡§æ‡§§‡§æ‡§∞ ‡§ö‡§∞‡§ø‡§§‡§æ‡§∞‡•ç‡§• ‡§ï‡§∞ ‡§∞‡§π‡§æ ‡§π‡•à‡•§ Our institution continues to uphold these sacred values, adhering to the rules framed by the MP Board and providing quality education to students of diverse backgrounds.
                    </p>
                </div>

                <div class="values-grid">
                    <div class="value-card reveal">
                        <div class="value-icon">üéØ</div>
                        <h3>Our Aim</h3>
                        <p id="aim-description">Building students with conscience, competence, compassion and commitment. We prepare every learner to amalgamate traditional and modern facets of education, enabling them to cope with the contemporary world and achieve excellence in every sphere of life.</p>
                    </div>
                    
                    <div class="value-card reveal">
                        <div class="value-icon">üåü</div>
                        <h3>Our Mission</h3>
                        <p id="mission-description">To nurture different strata of society by imparting knowledge and unlocking the true potential of young minds. We provide holistic development through character building and child-centric education, stimulating scholars to explore their innate talents.</p>
                    </div>
                    
                    <div class="value-card reveal">
                        <div class="value-icon">üëÅÔ∏è</div>
                        <h3>Our Vision</h3>
                        <p id="vision-description">Academic excellence aligned with shifts in the global economy, society and environment. Our dexterous educators nurture, chisel and inflame the intellect of juvenile minds, envisaging a luminous path for students to become self-reliant citizens with exemplary values.</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

        <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Contact Information</h3>
                    <p>Shri Guru Nanak Mission Girls High Secondary School</p>
                    <p>Established 1959 | MP Board Affiliated</p>
                    <p>Premnagar, Jabalpur</p>
                    <p>Phone no.0761-4020079, 0761-4020080</p>
                    <p>Phone no.+91-9201155288</p>
                </div>
                <div class="footer-section">
                    <h3>Certifications</h3>
                    <p>ISO Certified:9001:2015</p>
                    <p>Dise Code Hindi Medium:23390225411</p>
                    <p>Dise Code English Medium:23390225409</p>                    
                    <p>School Code:712010</p>
                    
                </div>
                <div class="footer-section">
                    <h3>Excellence Since 1959</h3>
                    <p>65 years of educational excellence</p>
                    <p>Nurturing leaders of tomorrow</p>
                    <p>Building character, inspiring dreams</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 Shri Guru Nanak Mission Girls High Secondary School. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        // =================
        // GOOGLE SHEETS API CONFIGURATION (UPDATED)
        // =================
        
        const GOOGLE_SHEETS_CONFIG = {
            SPREADSHEET_ID: '1M947pksberQ9C9JiW9XqHClVLs0Z1SKJUdhfZ_XyAv0',
            API_KEY: 'AIzaSyCLZPEfI5KbYuooE3FLXmti_8tI7BA6jFA',
            
            // Use actual sheet names instead of gid values
            SHEETS: {
                NOTICES: 'Notices',          // Actual sheet name
                SCHOOL_INFO: 'SchoolInfo',    // Actual sheet name
                RESULTS: 'Results',           // Actual sheet name
                EVENTS: 'Events'              // Actual sheet name
            }
        };

         function debugLog(message) {
            const debugPanel = document.getElementById('debugContent');
            const timestamp = new Date().toLocaleTimeString();
            debugPanel.innerHTML += `<div>[${timestamp}] ${message}</div>`;
            debugPanel.scrollTop = debugPanel.scrollHeight;
        }

        // Toggle debug panel
        document.getElementById('debugToggle').addEventListener('click', () => {
            const panel = document.getElementById('debugPanel');
            const toggle = document.getElementById('debugToggle');
            
            if (panel.style.display === 'none') {
                panel.style.display = 'block';
                toggle.textContent = 'Hide Debug';
            } else {
                panel.style.display = 'none';
                toggle.textContent = 'Show Debug';
            }
        });
        // =================
        // DATA FETCHING FUNCTIONS (FIXED)
        // =================
        
        async function fetchSheetData(sheetName) {
            // Encode the sheet name for URL safety
            const encodedSheetName = encodeURIComponent(sheetName);
            const url = `https://sheets.googleapis.com/v4/spreadsheets/${GOOGLE_SHEETS_CONFIG.SPREADSHEET_ID}/values/${encodedSheetName}?key=${GOOGLE_SHEETS_CONFIG.API_KEY}`;
            
            debugLog(`Fetching data from sheet: ${sheetName}`);
            
            try {
                const response = await fetch(url);
                
                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error.message || `HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                debugLog(`Received data for sheet: ${sheetName} (${data.values ? data.values.length : 0} rows)`);
                
                if (data.values && data.values.length > 1) {
                    const headers = data.values[0];
                    const rows = data.values.slice(1);
                    
                    return rows.map(row => {
                        const obj = {};
                        headers.forEach((header, index) => {
                            obj[header] = row[index] || '';
                        });
                        return obj;
                    });
                }
                return [];
            } catch (error) {
                debugLog(`ERROR fetching sheet data (${sheetName}): ${error.message}`);
                
                // Show user-friendly error message
                if (sheetName === GOOGLE_SHEETS_CONFIG.SHEETS.NOTICES) {
                    document.getElementById('notice-board').innerHTML = `
                        <h2>üì¢ Latest Announcements</h2>
                        <div class="error-message">
                            Could not load announcements. Please refresh the page or try again later.
                            <br><small>${error.message}</small>
                        </div>
                    `;
                }
                
                return [];
            }
        }

        // =================
        // CONTENT UPDATE FUNCTIONS
        // =================
        
        async function updateNotices() {
            const notices = await fetchSheetData(GOOGLE_SHEETS_CONFIG.SHEETS.NOTICES);
            const noticeContainer = document.getElementById('notice-board');
            
            if (notices.length > 0) {
                const activeNotices = notices
                    .filter(notice => notice.Status === 'Active')
                    .slice(0, 3); // Show only latest 3 notices
                
                if (activeNotices.length > 0) {
                    const noticesHTML = activeNotices.map(notice => `
                        <div class="notice-item">
                            <div class="notice-date">${formatDate(notice.Date)}</div>
                            <div>
                                <strong>${notice.Title}</strong><br>
                                ${notice.Description}
                            </div>
                        </div>
                    `).join('');
                    
                    noticeContainer.innerHTML = `
                        <h2>üì¢ Latest Announcements</h2>
                        ${noticesHTML}
                    `;
                } else {
                    noticeContainer.innerHTML = `
                        <h2>üì¢ Latest Announcements</h2>
                        <div class="notice-item">
                            <div>No current announcements available</div>
                        </div>
                    `;
                }
            }
        }

        async function updateSchoolInfo() {
            const schoolInfo = await fetchSheetData(GOOGLE_SHEETS_CONFIG.SHEETS.SCHOOL_INFO);
            
            if (schoolInfo.length > 0) {
                const info = schoolInfo[0]; // Assuming first row has main info
                
                // Update hero subtitle
                const subtitle = document.querySelector('.hero-text .subtitle');
                if (subtitle && info.HeroDescription) {
                    subtitle.textContent = info.HeroDescription;
                }
                
                // Update mission, vision, aim if provided
                if (info.AimDescription) {
                    document.getElementById('aim-description').textContent = info.AimDescription;
                }
                if (info.MissionDescription) {
                    document.getElementById('mission-description').textContent = info.MissionDescription;
                }
                if (info.VisionDescription) {
                    document.getElementById('vision-description').textContent = info.VisionDescription;
                }
            }
        }

        // =================
        // HELPER FUNCTIONS
        // =================
        
        function formatDate(dateString) {
            if (!dateString) return '--';
            
            try {
                const date = new Date(dateString);
                if (isNaN(date.getTime())) {
                    return dateString; // Return original if invalid date
                }
                const day = date.getDate();
                const month = date.toLocaleDateString('en-US', { month: 'short' });
                return `${day}<br>${month}`;
            } catch (e) {
                console.error('Error formatting date:', e);
                return dateString;
            }
        }

        // =================
        // API CONNECTION TESTING
        // =================
        
        async function testApiConnection() {
            try {
                // Test with a simple request to check API access
                const testUrl = `https://sheets.googleapis.com/v4/spreadsheets/${GOOGLE_SHEETS_CONFIG.SPREADSHEET_ID}?fields=properties.title&key=${GOOGLE_SHEETS_CONFIG.API_KEY}`;
                const response = await fetch(testUrl);
                
                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.error.message);
                }
                
                return true;
            } catch (error) {
                debugLog('Google Sheets API connection failed: ' + error.message);
                
                // Show error banner
                const errorBanner = document.createElement('div');
                errorBanner.className = 'api-error-banner';
                errorBanner.innerHTML = `
                    ‚ö†Ô∏è Connection to school data failed. Showing limited information. 
                    <br><small>${error.message}</small>
                `;
                document.body.prepend(errorBanner);
                
                return false;
            }
        }

        // =================
        // MAIN INITIALIZATION
        // =================
        
        async function initializeData() {
            debugLog('Initializing data...');
            
            // First verify API connection
            const apiConnected = await testApiConnection();
            
            if (!apiConnected) {
                debugLog('API connection failed - loading fallback content');
                loadFallbackContent();
                return;
            }
            
            // Then load data
            debugLog('API connection successful - fetching data');
            await Promise.all([
                updateNotices(),
                updateSchoolInfo()
            ]);
            
            debugLog('Data initialization complete');
        }

        function loadFallbackContent() {
            debugLog('Loading fallback content');
            
            // Default content if API fails
            document.getElementById('notice-board').innerHTML = `
                <h2>üì¢ Latest Announcements</h2>
                <div class="notice-item">
                    <div class="notice-date">18<br>Nov</div>
                    <div>
                        <strong>Admissions Open</strong><br>
                        Nursery 2025-2026 session applications now being accepted
                    </div>
                </div>
            `;
        }

        // =================
        // AUTO-REFRESH FUNCTIONALITY
        // =================
        
        function setupAutoRefresh() {
            // Refresh data every 5 minutes (300000 ms)
            setInterval(async () => {
                debugLog('üîÑ Refreshing data from Google Sheets...');
                await initializeData();
            }, 300000);
        }

        // =================
        // PAGE INITIALIZATION
        // =================
        
        document.addEventListener('DOMContentLoaded', async () => {
            debugLog('DOM fully loaded and parsed');
            
            // Initialize data
            await initializeData();
            
            // Setup auto-refresh
            setupAutoRefresh();
            
            // Initialize animations
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('active');
                    }
                });
            }, {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            });

            document.querySelectorAll('.reveal').forEach(el => {
                observer.observe(el);
            });
            
            // Header scroll effect
            window.addEventListener('scroll', () => {
                const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                const header = document.querySelector('header');
                
                if (scrollTop > 100) {
                    header.style.background = 'rgba(255, 255, 255, 0.98)';
                    header.style.boxShadow = '0 2px 20px rgba(139, 0, 0, 0.1)';
                } else {
                    header.style.background = 'rgba(255, 255, 255, 0.95)';
                    header.style.boxShadow = 'none';
                }
            });
            
            // Smooth scrolling for navigation
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                });
            });
        });
    </script>
</body>
</html>
